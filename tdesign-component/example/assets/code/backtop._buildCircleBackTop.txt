
 class _TDBackTopPageState extends State<TDBackTopPage> {
  ScrollController controller = ScrollController();
  bool showBackTop = false;
  TDBackTopStyle style = TDBackTopStyle.circle;

  @override
  void initState() {
    super.initState();
    controller.addListener(listenCallback);
  }

  @override
  void dispose() {
    super.dispose();
    controller.removeListener(listenCallback);
  }

  void listenCallback() {
    if (controller.offset >= 100) {
      if (!showBackTop) {
        setState(() {
          showBackTop = true;
        });
      }
    } else {
      if (showBackTop) {
        setState(() {
          showBackTop = false;
        });
      }
    }
  }

  @override
  Widget build(BuildContext context) {
    return ExamplePage(
        scrollController: controller,
        title: tdTitle(),
        desc: '用于当页面过长往下滑动时，帮助用户快速回到页面顶部。',
        exampleCodeGroup: 'backtop',
        floatingActionButton: Stack(
          clipBehavior: Clip.none,
          children: [
            Visibility(
                visible: showBackTop,
                child: Positioned(
                    right: -16,
                    bottom: 10,
                    child: TDBackTop(
                      controller: controller,
                      theme: TDBackTopTheme.dark,
                      showText: true,
                      style: style,
                    )))
          ],
        ),
        children: [
          ExampleModule(title: '组件类型', children: [
            ExampleItem(desc: '圆形返回顶部', builder: _buildCircleBackTop),
          ])
        ]);
  }

  @Demo(group: 'backtop')
  Widget _buildCircleBackTop(BuildContext context) {
    return getCustomButton(context, '圆形返回顶部', () {
      setState(() {
        showBackTop = true;
        if (controller.hasClients) {
          controller.jumpTo(500);
        }
        style = TDBackTopStyle.circle;
      });
    });
  }

  Widget getCustomButton(
      BuildContext context, String text, void Function() onTap) {
    return Padding(
        padding: const EdgeInsets.symmetric(horizontal: 16),
        child: TDButton(
          text: text,
          width: MediaQuery.of(context).size.width - 16 * 2,
          size: TDButtonSize.large,
          type: TDButtonType.outline,
          shape: TDButtonShape.rectangle,
          theme: TDButtonTheme.primary,
          onTap: onTap,
        ));
  }
}
